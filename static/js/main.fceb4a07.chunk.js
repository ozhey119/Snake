(this.webpackJsonpsnake=this.webpackJsonpsnake||[]).push([[0],{33:function(e,t,n){},42:function(e,t,n){},74:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n(1),o=n.n(r),i=n(34),a=n.n(i),s=(n(42),n(17)),l=n(2),u=n(35),d=n.n(u),h=n(36);function j(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}n(33);var b=function(e){var t=e.gameState;if(!t)return null;var n=Object.values(t.snakes).map((function(e){return Object(c.jsx)("div",{style:{backgroundColor:e.color},className:"score-item",children:e.score},e.color)}));return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("h2",{className:"text-shadow",children:"Scores:"}),Object(c.jsx)("div",{className:"flex-scores",children:n})]})},f=function(){var e,t,n,o=Object(r.useRef)(null),i=Object(r.useState)(!1),a=Object(l.a)(i,2),u=a[0],f=a[1],O=Object(r.useState)(),m=Object(l.a)(O,2),w=m[0],x=m[1],v=Object(r.useState)({width:480,height:480,color:"oldlace",scale:20}),g=Object(l.a)(v,2),p=g[0],k=g[1],S=Object(r.useState)(),y=Object(l.a)(S,2),N=y[0],R=y[1],C=Object(r.useState)(),E=Object(l.a)(C,2),A=E[0],D=E[1],L=Object(r.useState)(""),T=Object(l.a)(L,2),P=T[0],F=T[1],I=Object(r.useState)(),M=Object(l.a)(I,2),B=M[0],G=M[1],U=Object(r.useRef)(),z=function(){var e=Object(r.useState)(j()),t=Object(l.a)(e,2),n=t[0],c=t[1];return Object(r.useEffect)((function(){function e(){c(j())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),n}(),J=z.height,W=z.width,H=Object(h.useSwipeable)({onSwipedLeft:function(){return q({key:"ArrowLeft"})},onSwipedRight:function(){return q({key:"ArrowRight"})},onSwipedUp:function(){return q({key:"ArrowUp"})},onSwipedDown:function(){return q({key:"ArrowDown"})}}),K=function(){R(),x(),G(),D(),G()};Object(r.useEffect)((function(){return U.current=d()("https://lit-caverns-07351.herokuapp.com"),U.current.on("connect",(function(){f(!0)})),U.current.on("disconnect",(function(){f(!1),K()})),U.current.on("gameState",(function(e){x(e)})),U.current.on("gameEnd",(function(e){Object.keys(e.snakes).length>1&&(e.hasOwnProperty("lastSurvivor")&&Object.keys(e.snakes).length>1?G(e.lastSurvivor):G("Tie"))})),U.current.on("initGame",(function(e){G();var t=Math.min(window.innerWidth,600),n=e.width/t;k({width:.8*t,height:e.height/n*.8,color:e.color,scale:e.scale/n*.8})})),U.current.on("joinedRoom",(function(e){R(e)})),U.current.on("leftRoom",(function(){K()})),function(){return U.current.disconnect()}}),[]);var Y=Object(r.useCallback)((function(){var e=o.current.getContext("2d");return e.fillStyle=p.color,e.fillRect(0,0,p.width,p.height),e}),[p]);Object(r.useEffect)((function(){k((function(e){var t=Math.min(W,600),n=e.width/t;return{width:.8*t,height:e.height/n*.8,color:e.color,scale:e.scale/n*.8}}))}),[W,J]),Object(r.useEffect)((function(){Y().setTransform(p.scale,0,0,p.scale,0,0)}),[p,Y,A]),Object(r.useEffect)((function(){if(w){var e=w.snakes,t=w.apple,n=Y();Object.values(e).forEach((function(e){n.fillStyle=e.color,e.body.forEach((function(e){return n.fillRect(e.x,e.y,1,1)}))})),n.fillStyle="red",n.beginPath(),n.arc(t.x+.5,t.y+.575,.425,0,2*Math.PI),n.closePath(),n.fill(),n.fillStyle="green",n.fillRect(t.x+.5,t.y,.3,.15)}}),[w,p,Y]);var q=function(e){"Space"===e.code?U.current.emit("newGame",N,A):(!e.preventDefault||"ArrowUp"!==e.code&&"ArrowDown"!==e.code&&"ArrowLeft"!==e.code&&"ArrowRight"!==e.code||e.preventDefault(),U.current.emit("keyDown",e.code,N))},Q=function(e,t){D(t),U.current.emit("joinRoom",e,t)};return"room"===A&&w&&w.snakes[U.current.id]&&(t=Object(c.jsxs)("h2",{style:{margin:"10px 0px -15px"},className:"text-shadow",children:["Your color is ",Object(c.jsx)("span",{style:{color:w.snakes[U.current.id].color},children:w.snakes[U.current.id].color})]})),e=N?Object(c.jsxs)("div",{className:"options",children:[Object(c.jsx)("button",{onClick:function(){return U.current.emit("newGame",N,A)},className:"button-red",children:"Start game"}),Object(c.jsx)("button",{onClick:function(){return U.current.emit("leaveRoom",N)},className:"button-red",children:"Back to menu"})]}):Object(c.jsxs)("div",{className:"options center",children:[Object(c.jsx)("h1",{className:"title text-shadow",children:"Snake"}),Object(c.jsx)("button",{onClick:function(){return Q(U.current.id,"solo")},className:"button-red",children:"Solo"}),Object(c.jsx)("button",{onClick:function(){return Q(U.current.id,"local2p")},className:"button-red",children:"Local 2 players"}),Object(c.jsx)("input",{type:"text",placeholder:"Room name",onChange:function(e){return F(e.target.value)}}),Object(c.jsx)("button",{onClick:function(){return Q(P,"room")},className:"button-red",children:"Enter room"}),u?Object(c.jsx)("div",{className:"good",children:"connected"}):Object(c.jsx)("div",{className:"bad",children:"connecting..."})]}),"Tie"===B?n=Object(c.jsx)("h2",{className:"text-shadow",children:"The game ended with a tie!"}):B&&(n=Object(c.jsxs)("h2",{className:"text-shadow",children:["The last survivor is ",Object(c.jsx)("span",{style:{color:B},children:B})]})),Object(c.jsx)("div",{className:"snake-game",children:Object(c.jsxs)("div",Object(s.a)(Object(s.a)({role:"button",tabIndex:"0",onKeyDown:q},H),{},{className:"snake-container",children:[t,undefined,Object(c.jsx)("canvas",{style:N?{display:"block"}:{display:"none"},className:"snake-canvas",ref:o,width:"".concat(p.width,"px"),height:"".concat(p.height,"px")}),e,n,Object(c.jsx)(b,{gameState:w})]}))})},O=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,75)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),o(e),i(e)}))};a.a.render(Object(c.jsx)(o.a.StrictMode,{children:Object(c.jsx)(f,{})}),document.getElementById("root")),O()}},[[74,1,2]]]);
//# sourceMappingURL=main.fceb4a07.chunk.js.map