{"version":3,"sources":["customHooks.js","Scores.js","App.js","reportWebVitals.js","index.js"],"names":["getWindowDimensions","window","width","innerWidth","height","innerHeight","Scores","gameState","scores","Object","values","snakes","map","snake","style","backgroundColor","color","className","score","App","options","currentSnakeColor","gameResult","canvasRef","useRef","useState","isConnected","setIsConnected","setGameState","scale","canvas","setCanvas","roomName","setRoomName","mode","setMode","roomInput","setRoomInput","winner","setWinner","socketRef","windowDimensions","setWindowDimensions","useEffect","handleResize","addEventListener","removeEventListener","useWindowDimensions","swipeHandlers","useSwipeable","onSwipedLeft","handleKeyDown","key","onSwipedRight","onSwipedUp","onSwipedDown","reset","current","socketIOClient","on","state","keys","length","hasOwnProperty","lastSurvivor","initCanvas","maxWidth","Math","min","multiplier","disconnect","initBlankCanvas","useCallback","context","getContext","fillStyle","fillRect","prevCanvas","setTransform","apple","forEach","body","segment","x","y","beginPath","arc","PI","closePath","fill","e","code","emit","preventDefault","handleJoinRoom","room","id","margin","onClick","type","placeholder","onChange","target","value","role","tabIndex","onKeyDown","gameBoard","display","ref","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.fceb4a07.chunk.js","sourcesContent":["// Custom Hook by Dan Abramov\r\nimport { useEffect, useState, useRef } from 'react';\r\n\r\nexport function useInterval(callback, delay) {\r\n  const savedCallback = useRef();\r\n\r\n  // Remember the latest callback.\r\n  useEffect(() => {\r\n    savedCallback.current = callback;\r\n  }, [callback]);\r\n\r\n  // Set up the interval.\r\n  useEffect(() => {\r\n    function tick() {\r\n      savedCallback.current();\r\n    }\r\n    if (delay !== null) {\r\n      let id = setInterval(tick, delay);\r\n      return () => clearInterval(id);\r\n    }\r\n  }, [delay]);\r\n}\r\n\r\nfunction getWindowDimensions() {\r\n  const { innerWidth: width, innerHeight: height } = window;\r\n  return {\r\n    width,\r\n    height\r\n  };\r\n}\r\n\r\nexport function useWindowDimensions() {\r\n  const [windowDimensions, setWindowDimensions] = useState(getWindowDimensions());\r\n\r\n  useEffect(() => {\r\n    function handleResize() {\r\n      setWindowDimensions(getWindowDimensions());\r\n    }\r\n\r\n    window.addEventListener('resize', handleResize);\r\n    return () => window.removeEventListener('resize', handleResize);\r\n  }, []);\r\n\r\n  return windowDimensions;\r\n}","import React from \"react\";\r\nimport './App.css'\r\n\r\nconst Scores = ({ gameState }) => {\r\n    if (!gameState) {\r\n        return null;\r\n    }\r\n    const scores = Object.values(gameState.snakes).map((snake) =>\r\n        <div key={snake.color} style={{ backgroundColor: snake.color }} className='score-item'>{snake.score}</div>)\r\n\r\n    return (\r\n        <>\r\n            <h2 className='text-shadow'>Scores:</h2>\r\n            <div className='flex-scores'>\r\n                {scores}\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default Scores;","import React, { useEffect, useState, useRef, useCallback } from \"react\";\nimport socketIOClient from \"socket.io-client\";\nimport { useSwipeable } from \"react-swipeable\";\nimport { useWindowDimensions } from './customHooks';\nimport Scores from './Scores';\nimport './App.css'\nconst MAX_WINDOW_WIDTH = 600; //The true maximum width is around 80% of the const value\n\nconst App = () => {\n    const canvasRef = useRef(null);\n    const [isConnected, setIsConnected] = useState(false);\n    const [gameState, setGameState] = useState();\n    const [canvas, setCanvas] = useState({ width: 480, height: 480, color: \"oldlace\", scale: 20 })\n    const [roomName, setRoomName] = useState();\n    const [mode, setMode] = useState();\n    const [roomInput, setRoomInput] = useState('');\n    const [winner, setWinner] = useState();\n    const socketRef = useRef();\n    const { height, width } = useWindowDimensions();\n    let options, gameBoard, currentSnakeColor, gameResult;\n\n    const swipeHandlers = useSwipeable({\n        onSwipedLeft: () => handleKeyDown({ key: \"ArrowLeft\" }),\n        onSwipedRight: () => handleKeyDown({ key: \"ArrowRight\" }),\n        onSwipedUp: () => handleKeyDown({ key: \"ArrowUp\" }),\n        onSwipedDown: () => handleKeyDown({ key: \"ArrowDown\" })\n    });\n\n    const reset = () => {\n        setRoomName();\n        setGameState();\n        setWinner();\n        setMode();\n        setWinner();\n    }\n\n    useEffect(() => {\n        socketRef.current = socketIOClient(\"https://lit-caverns-07351.herokuapp.com\");\n        socketRef.current.on('connect', function () {\n            setIsConnected(true);\n        });\n        socketRef.current.on('disconnect', function () {\n            setIsConnected(false);\n            reset();\n        });\n        socketRef.current.on('gameState', (state) => {\n            setGameState(state);\n        })\n        socketRef.current.on('gameEnd', (state) => {\n            if (Object.keys(state.snakes).length > 1) {\n                if (state.hasOwnProperty('lastSurvivor') && Object.keys(state.snakes).length > 1) {\n                    setWinner(state.lastSurvivor);\n                } else {\n                    setWinner('Tie');\n                }\n            }\n        })\n        socketRef.current.on('initGame', (initCanvas) => {\n            setWinner();\n            const maxWidth = Math.min(window.innerWidth, MAX_WINDOW_WIDTH);\n            const multiplier = initCanvas.width / maxWidth;\n            setCanvas({\n                width: maxWidth * 0.8,\n                height: initCanvas.height / multiplier * 0.8,\n                color: initCanvas.color,\n                scale: initCanvas.scale / multiplier * 0.8\n            })\n        })\n        socketRef.current.on('joinedRoom', (roomName) => {\n            setRoomName(roomName);\n        })\n        socketRef.current.on('leftRoom', () => {\n            reset();\n        })\n        return () => socketRef.current.disconnect();\n    }, []);\n\n    const initBlankCanvas = useCallback(\n        () => {\n            const context = canvasRef.current.getContext(\"2d\");\n            context.fillStyle = canvas.color;\n            context.fillRect(0, 0, canvas.width, canvas.height);\n            return context;\n        },\n        [canvas],\n    );\n\n    useEffect(() => {\n        setCanvas(prevCanvas => {\n            const maxWidth = Math.min(width, MAX_WINDOW_WIDTH);\n            const multiplier = prevCanvas.width / maxWidth;\n            return {\n                width: maxWidth * 0.8,\n                height: prevCanvas.height / multiplier * 0.8,\n                color: prevCanvas.color,\n                scale: prevCanvas.scale / multiplier * 0.8\n            }\n        })\n    }, [width, height])\n\n    useEffect(() => {\n        const context = initBlankCanvas();\n        context.setTransform(canvas.scale, 0, 0, canvas.scale, 0, 0);\n    }, [canvas, initBlankCanvas, mode])\n\n    useEffect(() => {\n        if (gameState) {\n            const { snakes, apple } = gameState;\n            const context = initBlankCanvas();\n            Object.values(snakes).forEach(snake => {\n                context.fillStyle = snake.color;\n                snake.body.forEach((segment) => context.fillRect(segment.x, segment.y, 1, 1))\n            })\n            context.fillStyle = 'red';\n            context.beginPath();\n            context.arc(apple.x + 0.5, apple.y + 0.575, 0.425, 0, 2 * Math.PI);\n            context.closePath();\n            context.fill();\n            context.fillStyle = 'green';\n            context.fillRect(apple.x + 0.5, apple.y, 0.3, 0.15);\n        }\n    }, [gameState, canvas, initBlankCanvas])\n\n    const handleKeyDown = (e) => {\n        if (e.code === \"Space\") {\n            socketRef.current.emit('newGame', roomName, mode)\n        } else {\n            if (e.preventDefault && (e.code === 'ArrowUp' || e.code === 'ArrowDown' || e.code === 'ArrowLeft' || e.code === 'ArrowRight')) {\n                e.preventDefault();\n            }\n            socketRef.current.emit('keyDown', e.code, roomName)\n        }\n    }\n\n    const handleJoinRoom = (room, mode) => {\n        setMode(mode);\n        socketRef.current.emit('joinRoom', room, mode);\n    }\n\n    if (mode === 'room' && gameState && gameState.snakes[socketRef.current.id]) {\n        currentSnakeColor = <h2 style={{ margin: '10px 0px -15px' }} className='text-shadow'>Your color is <span style={{ color: gameState.snakes[socketRef.current.id].color }}>{gameState.snakes[socketRef.current.id].color}</span></h2>\n    }\n\n    if (roomName) { // Player entered a room or chose local mode\n        options = <div className='options'>\n            <button\n                onClick={() => socketRef.current.emit('newGame', roomName, mode)}\n                className='button-red'>Start game\n            </button>\n            <button\n                onClick={() => socketRef.current.emit('leaveRoom', roomName)}\n                className='button-red'>Back to menu\n            </button>\n        </div>\n    } else {\n        options = <div className='options center'>\n            <h1 className='title text-shadow'>Snake</h1>\n            <button\n                onClick={() => handleJoinRoom(socketRef.current.id, 'solo')}\n                className='button-red'>\n                Solo\n            </button>\n            <button\n                onClick={() => handleJoinRoom(socketRef.current.id, 'local2p')}\n                className='button-red'>\n                Local 2 players\n            </button>\n            <input type=\"text\" placeholder=\"Room name\" onChange={(e) => setRoomInput(e.target.value)} />\n            <button\n                onClick={() => handleJoinRoom(roomInput, 'room')}\n                className='button-red'>\n                Enter room\n            </button>\n            {isConnected ? <div className='good'>connected</div> : \n            <div className='bad'>connecting...</div>}\n        </div>\n    }\n    if (winner === 'Tie') {\n        gameResult = <h2 className='text-shadow'>The game ended with a tie!</h2>\n    } else if (winner) {\n        gameResult = <h2 className='text-shadow'>The last survivor is <span style={{ color: winner }}>{winner}</span></h2>\n    }\n\n    return (\n        <div className='snake-game'>\n            <div role=\"button\" tabIndex=\"0\" onKeyDown={handleKeyDown} {...swipeHandlers} className='snake-container'>\n                {currentSnakeColor}\n                {gameBoard}\n                <canvas style={roomName ? { display: 'block' } : { display: 'none' }}\n                    className='snake-canvas'\n                    ref={canvasRef}\n                    width={`${canvas.width}px`}\n                    height={`${canvas.height}px`}\n                />\n                {options}\n                {gameResult}\n                <Scores gameState={gameState} />\n            </div>\n        </div>\n    )\n}\n\nexport default App;","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();"],"sourceRoot":""}