(this.webpackJsonpsnake=this.webpackJsonpsnake||[]).push([[0],{33:function(e,t,n){},42:function(e,t,n){},74:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n(1),o=n.n(r),i=n(34),s=n.n(i),a=(n(42),n(17)),l=n(7),u=n(35),d=n.n(u),h=n(36);function j(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}n(33);var f=function(e){var t=e.gameState;if(!t)return null;var n=Object.values(t.snakes).map((function(e){return Object(c.jsx)("div",{style:{backgroundColor:e.color},className:"score-item",children:e.score},e.color)}));return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("h2",{className:"text-shadow",children:"Scores:"}),Object(c.jsx)("div",{className:"flex-scores",children:n})]})},b=function(){var e,t,n,o=Object(r.useRef)(null),i=Object(r.useState)(),s=Object(l.a)(i,2),u=s[0],b=s[1],m=Object(r.useState)({width:480,height:480,color:"oldlace",scale:20}),O=Object(l.a)(m,2),w=O[0],g=O[1],x=Object(r.useState)(),k=Object(l.a)(x,2),p=k[0],v=k[1],y=Object(r.useState)(),S=Object(l.a)(y,2),N=S[0],R=S[1],C=Object(r.useState)(""),E=Object(l.a)(C,2),A=E[0],D=E[1],L=Object(r.useState)(),T=Object(l.a)(L,2),P=T[0],F=T[1],I=Object(r.useRef)(),M=function(){var e=Object(r.useState)(j()),t=Object(l.a)(e,2),n=t[0],c=t[1];return Object(r.useEffect)((function(){function e(){c(j())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),n}(),B=M.height,G=M.width,U=Object(h.useSwipeable)({onSwipedLeft:function(){return W({key:"ArrowLeft"})},onSwipedRight:function(){return W({key:"ArrowRight"})},onSwipedUp:function(){return W({key:"ArrowUp"})},onSwipedDown:function(){return W({key:"ArrowDown"})}}),z=function(){v(),b(),F(),R(),F()};Object(r.useEffect)((function(){return I.current=d()("https://stormy-taiga-60599.herokuapp.com"),I.current.on("connect",(function(){console.log("connected")})),I.current.on("disconnect",(function(){console.log("disconnected"),z()})),I.current.on("gameState",(function(e){b(e)})),I.current.on("gameEnd",(function(e){Object.keys(e.snakes).length>1&&(e.hasOwnProperty("lastSurvivor")&&Object.keys(e.snakes).length>1?F(e.lastSurvivor):F("Tie"))})),I.current.on("initGame",(function(e){F();var t=Math.min(window.innerWidth,600),n=e.width/t;g({width:.8*t,height:e.height/n*.8,color:e.color,scale:e.scale/n*.8})})),I.current.on("joinedRoom",(function(e){v(e)})),I.current.on("leftRoom",(function(){z()})),function(){return I.current.disconnect()}}),[]);var J=Object(r.useCallback)((function(){var e=o.current.getContext("2d");return e.fillStyle=w.color,e.fillRect(0,0,w.width,w.height),e}),[w]);Object(r.useEffect)((function(){g((function(e){var t=Math.min(G,600),n=e.width/t;return{width:.8*t,height:e.height/n*.8,color:e.color,scale:e.scale/n*.8}}))}),[G,B]),Object(r.useEffect)((function(){console.log("new"),J().setTransform(w.scale,0,0,w.scale,0,0)}),[w,J,N]),Object(r.useEffect)((function(){if(u){var e=u.snakes,t=u.apple,n=J();Object.values(e).forEach((function(e){n.fillStyle=e.color,e.body.forEach((function(e){return n.fillRect(e.x,e.y,1,1)}))})),n.fillStyle="red",n.beginPath(),n.arc(t.x+.5,t.y+.575,.425,0,2*Math.PI),n.closePath(),n.fill(),n.fillStyle="green",n.fillRect(t.x+.5,t.y,.3,.15)}}),[u,w,J]);var W=function(e){" "===e.key?I.current.emit("newGame",p,N):(!e.preventDefault||"ArrowUp"!==e.key&&"ArrowDown"!==e.key&&"ArrowLeft"!==e.key&&"ArrowRight"!==e.key||e.preventDefault(),I.current.emit("keyDown",e.key,p))},H=function(e,t){R(t),I.current.emit("joinRoom",e,t)};return"room"===N&&u&&u.snakes[I.current.id]&&(t=Object(c.jsxs)("h2",{style:{margin:"10px 0px -15px"},className:"text-shadow",children:["Your color is ",Object(c.jsx)("span",{style:{color:u.snakes[I.current.id].color},children:u.snakes[I.current.id].color})]})),e=p?Object(c.jsxs)("div",{className:"options",children:[Object(c.jsx)("button",{onClick:function(){return I.current.emit("newGame",p,N)},className:"button-red",children:"Start game"}),Object(c.jsx)("button",{onClick:function(){return I.current.emit("leaveRoom",p)},className:"button-red",children:"Back to menu"})]}):Object(c.jsxs)("div",{className:"options center",children:[Object(c.jsx)("h1",{className:"title text-shadow",children:"Snake"}),Object(c.jsx)("button",{onClick:function(){return H(I.current.id,"solo")},className:"button-red",children:"Solo"}),Object(c.jsx)("button",{onClick:function(){return H(I.current.id,"local2p")},className:"button-red",children:"Local 2 players"}),Object(c.jsx)("input",{type:"text",placeholder:"Room name",onChange:function(e){return D(e.target.value)}}),Object(c.jsx)("button",{onClick:function(){return H(A,"room")},className:"button-red",children:"Enter room"})]}),"Tie"===P?n=Object(c.jsx)("h2",{className:"text-shadow",children:"The game ended with a tie!"}):P&&(n=Object(c.jsxs)("h2",{className:"text-shadow",children:["The last survivor is ",Object(c.jsx)("span",{style:{color:P},children:P})]})),Object(c.jsx)("div",{className:"snake-game",children:Object(c.jsxs)("div",Object(a.a)(Object(a.a)({role:"button",tabIndex:"0",onKeyDown:W},U),{},{className:"snake-container",children:[t,undefined,Object(c.jsx)("canvas",{style:p?{display:"block"}:{display:"none"},className:"snake-canvas",ref:o,width:"".concat(w.width,"px"),height:"".concat(w.height,"px")}),e,n,Object(c.jsx)(f,{gameState:u})]}))})},m=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,75)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),o(e),i(e)}))};s.a.render(Object(c.jsx)(o.a.StrictMode,{children:Object(c.jsx)(b,{})}),document.getElementById("root")),m()}},[[74,1,2]]]);
//# sourceMappingURL=main.69592dcf.chunk.js.map